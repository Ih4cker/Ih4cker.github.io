<!DOCTYPE html>
<html lang="zh-CN">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="" />
  <meta name="author" content="linkin" />
  <meta name="description" content="" />
  
  
  <title>
    
      反编译PC微信小程序 
      
      
      |
    
     API漫步者
  </title>

  
    <link rel="apple-touch-icon" href="/images/taici.ico">
    <link rel="icon" href="/images/taici.ico">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">


  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BQYXWP12R6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-BQYXWP12R6');
    </script>
  

<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="API漫步者" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/me.jpg" alt="">
      
    </a>
    <div class="nickname"><a href="/">Linkin</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">首页</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">归档</a>
        </li>
      
        <li class="nav-item" data-path="/categories/">
          <a href="/categories/">分类</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">标签</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">关于</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->

<!-- LaTex Display -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>



  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">反编译PC微信小程序</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime" title="更新时间"></i>
          2020-11-20 16:50:06
        </span>
        
              <span class="post-categories">
                <i class="iconfont icon-bookmark" title="分类"></i>
                
                <span class="span--category">
                  <a href="/categories/%E5%8F%8D%E7%BC%96%E8%AF%91/" title="反编译">
                    <b>#</b> 反编译
                  </a>
                </span>
                
              </span>
          
              <span class="post-tags">
                <i class="iconfont icon-tags" title="标签"></i>
                
                <span class="span--tag">
                  <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" title="微信小程序">
                    <b>#</b> 微信小程序
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <h2 id="0-解密小程序wxapkg包"><a href="#0-解密小程序wxapkg包" class="headerlink" title="0.解密小程序wxapkg包"></a>0.解密小程序wxapkg包</h2><p>pc端的微信小程序与移动端不同，pc端对小程序包(例如<code>__APP__.wxapkg</code>)进行了加密,加密详细请见<a target="_blank" rel="noopener" href="https://blog.csdn.net/yeyiqun/article/details/109172556">此处</a>，所以我们使用微信小程序反编译工具来反编译<code>wxapkg</code>包会报错，<br>一般存放某个pc微信小程序包的路径为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\&lt;用户名&gt;\Documents\WeChat Files\Applet\&lt;小程序的wxid&gt;\&lt;数字&gt;\&lt;小程序包名.wxapkg&gt;</span><br></pre></td></tr></table></figure>
<p>类似下图：<br><img src="https://i.loli.net/2020/11/20/Bqla9X83kizMfbc.png" alt="0.png"><br><img src="https://i.loli.net/2020/11/20/kx6Z8mOo42JYdeU.png" alt="1.png"></p>
<p>其中的<code>wx5bfb6b535af31da3</code>便是微信小程序<code>今日最热榜</code>的<code>wxid</code>,此字符串用于对小程序包的解密，需要用到。</p>
<blockquote>
<p>ps:如果发现找不到对应的wxapkg包，那么打开PC微信，并打开小程序<code>今日最热榜</code>便可以将其小程序包下载至本地，如果在一下路径中发现包太多，那么全部删除剩下<code>publicLib</code>文件夹，再打开<code>今日最热榜</code>便可以看到唯一一个小程序包文件夹。</p>
</blockquote>
<p>此时解密小程序包的条件已达成：</p>
<ul>
<li>小程序包<strong>APP</strong>.wxapkg</li>
<li>小程序wxid:wx5bfb6b535af31da3</li>
<li>安装Crypto的python3.7环境</li>
<li>解密python脚本</li>
</ul>
<p>解密脚本<code>decrypt.py</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA1</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># 微信小程序包 自定义标识</span></span><br><span class="line">WXAPKG_FLAG = <span class="string">&#x27;V1MMWX&#x27;</span></span><br><span class="line">WXAPKG_FLAG_LEN = <span class="built_in">len</span>(WXAPKG_FLAG)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;PC微信小程序wxapkg包解密工具&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--wxid&#x27;</span>, metavar=<span class="string">&#x27;微信小程序ID&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--iv&#x27;</span>, metavar=<span class="string">&#x27;iv&#x27;</span>, required=<span class="literal">False</span>, default=<span class="string">&#x27;the iv: 16 bytes&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--salt&#x27;</span>, metavar=<span class="string">&#x27;salt&#x27;</span>, required=<span class="literal">False</span>, default=<span class="string">&#x27;saltiest&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-f&#x27;</span>, <span class="string">&#x27;--file&#x27;</span>, metavar=<span class="string">&#x27;加密的小程序包文件路径&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, metavar=<span class="string">&#x27;解密后的小程序包文件路径&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    key = PBKDF2(args.wxid.encode(<span class="string">&#x27;utf-8&#x27;</span>), args.salt.encode(<span class="string">&#x27;utf-8&#x27;</span>), <span class="number">32</span>, count=<span class="number">1000</span>, hmac_hash_module=SHA1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取加密的内容</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(args.file):</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;文件不存在&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(args.file, mode=<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        dataByte = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> dataByte[<span class="number">0</span>:WXAPKG_FLAG_LEN].decode() != WXAPKG_FLAG:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;该文件无需解密, 或者不是微信小程序wxapkg加密包&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化密钥</span></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, args.iv.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解密头部1024个字节</span></span><br><span class="line">    originData = cipher.decrypt(dataByte[WXAPKG_FLAG_LEN: <span class="number">1024</span> + WXAPKG_FLAG_LEN])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化xor密钥, 解密剩余字节</span></span><br><span class="line">    xorKey = <span class="number">0x66</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args.wxid) &gt;= <span class="number">2</span>:</span><br><span class="line">        xorKey = <span class="built_in">ord</span>(args.wxid[<span class="built_in">len</span>(args.wxid) - <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    afData = dataByte[<span class="number">1024</span> + WXAPKG_FLAG_LEN:]</span><br><span class="line"></span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(afData)):</span><br><span class="line">        out.append(afData[i] ^ xorKey)</span><br><span class="line"></span><br><span class="line">    originData = originData[<span class="number">0</span>:<span class="number">1023</span>] + out</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 保存解密后的数据</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(args.output, mode=<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(originData)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&#x27;解密成功&#x27;</span>, args.output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>开始解密小程序包:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python decrypt.py  --wxid  &lt;小程序wxid&gt; --file &lt;小程序包&gt; -o &lt;输出解密后小程序包路径&gt;</span><br></pre></td></tr></table></figure>
<p>本例使用命令(小程序包<code>__APP__.wxapkg</code>与解密脚本放在同一路径下)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python decrypt.py  --wxid  wx5bfb6b535af31da3 --file __APP__.wxapkg -o decryptedAPP.wxapkg</span><br></pre></td></tr></table></figure>
<p>此时成功会发现当前路径下有新包：<code>decryptedAPP.wxapkg</code>，便是解密后的小程序包</p>
<p>类似下图：<br><img src="https://i.loli.net/2020/11/20/DiToum1Le2jK3cV.png" alt="2.png"><br><img src="https://i.loli.net/2020/11/20/UpPVx3Fic4so6Wh.png" alt="3.png"></p>
<h2 id="1-反编译wxapkg包"><a href="#1-反编译wxapkg包" class="headerlink" title="1.反编译wxapkg包"></a>1.反编译wxapkg包</h2><p>获取到解密后的wxapkg，那么可以使用<code>wxappUnpacker</code>对解密后的<code>decryptedAPP.wxapkg</code>进行反编译，首先安装<code>wxappUnpacker</code>,<br><a target="_blank" rel="noopener" href="https://github.com/leakC/wxappUnpacker-1">详见此处</a>,安装后将<code>decryptedAPP.wxapkg</code>放在<code>wxappUnpacker</code>文件夹下，<br>反编译命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ node wuWxapkg.js &lt;解密后小程序包&gt;</span><br></pre></td></tr></table></figure>
<p>本例使用命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ node wuWxapkg.js decryptedAPP.wxapkg</span><br></pre></td></tr></table></figure>
<p>类似下图：<br><img src="https://i.loli.net/2020/11/20/JBR64omvOd8NMVZ.png" alt="5.png"><br><img src="https://i.loli.net/2020/11/20/W4MUliVfsHk2BEF.png" alt="4.png"></p>
<p>成功后会发现与<code>decryptedAPP.wxapkg</code>同个路径下有同名文件夹<code>decryptedAPP</code>，结构类似：<br><img src="https://i.loli.net/2020/11/20/l8NDTQi7LVX69FY.png" alt="6.png"></p>
<p>至此简单的反编译流程跑通。</p>
<h2 id="2-寻找关键加密请求字段"><a href="#2-寻找关键加密请求字段" class="headerlink" title="2.寻找关键加密请求字段"></a>2.寻找关键加密请求字段</h2><p>本例中的小程序<code>今日最热榜</code>，打开后使用<code>Fiddler</code>进行抓包分析其接口参数：<br><img src="https://i.loli.net/2020/11/20/GhMBHxtIaNsAvz1.png" alt="7.png"></p>
<p>下拉小程序加载新闻流，可以发现对应接口为：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://m.toutiao.com/list/wxapp/?aid=1162&amp;ac=wap&amp;tag=news_entertainment&amp;format=json_raw&amp;count=20&amp;as=A1D5CF6B579B95B&amp;cp=5FB7CBF9D56B6E1&amp;enable_stick=&amp;max_behot_time=1605876032</span><br></pre></td></tr></table></figure>
<p>其中请求头部：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host: m.toutiao.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/532.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36 MicroMessenger/7.0.9.501 NetType/WIFI MiniProgramEnv/Windows WindowsWechat</span><br><span class="line">X-Traffic-Type: wxapp</span><br><span class="line">content-type: application/json</span><br><span class="line">Referer: https://servicewechat.com/wx5bfb6b535af31da3/2/page-frame.html</span><br></pre></td></tr></table></figure>
<p>对应参数：<br><img src="https://i.loli.net/2020/11/20/tMFaAHysXeGZ219.png" alt="8.png"><br>其中加密参数为：<code>as</code>,<code>cp</code></p>
<p>使用<code>WebStorm</code>打开文件夹<code>decryptedAPP</code>，全局查找关键词<code>as:</code>（注意有加英文冒号）,结果如下：<br><img src="https://i.loli.net/2020/11/20/EzvDWMVgIoq8aSR.png" alt="9.png"><br>js文件<code>ASCP.js</code>内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> md5 = <span class="built_in">require</span>(<span class="string">&quot;./md5.js&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ascp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nowTime = <span class="built_in">Math</span>.floor(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() / <span class="number">1e3</span>);</span><br><span class="line">    <span class="keyword">var</span> t_hex = nowTime.toString(<span class="number">16</span>).toUpperCase();</span><br><span class="line">    <span class="keyword">var</span> t_md5 = md5(nowTime).toString().toUpperCase();</span><br><span class="line">    <span class="keyword">if</span> (t_hex.length !== <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="keyword">as</span>: <span class="string">&quot;479BB4B7254C150&quot;</span>,</span><br><span class="line">            cp: <span class="string">&quot;7E0AC8874BB0985&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> pre = t_md5.slice(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">var</span> last = t_md5.slice(-<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">var</span> as_cy = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        as_cy += pre[i] + t_hex[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cp_cy = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">        cp_cy += t_hex[j + <span class="number">3</span>] + last[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="keyword">as</span>: <span class="string">&quot;A1&quot;</span> + as_cy + t_hex.slice(-<span class="number">3</span>),</span><br><span class="line">        cp: t_hex.slice(<span class="number">0</span>, <span class="number">3</span>) + cp_cy + <span class="string">&quot;E1&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = ascp;</span><br></pre></td></tr></table></figure>
<p>可以知道加密参数<code>as</code>,<code>cp</code>的生成代码，直接翻译为python:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ascp</span>():</span></span><br><span class="line">	now = <span class="built_in">int</span>(time.time())</span><br><span class="line">	t_hex = <span class="built_in">hex</span>(now).upper()[<span class="number">2</span>:]</span><br><span class="line">	md5 = hashlib.md5(<span class="built_in">bytes</span>(<span class="built_in">str</span>(now),<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest().upper()</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(t_hex) != <span class="number">8</span>:</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="string">&#x27;as&#x27;</span>: <span class="string">&quot;479BB4B7254C150&quot;</span>,</span><br><span class="line">			<span class="string">&#x27;cp&#x27;</span>: <span class="string">&quot;7E0AC8874BB0985&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">	pre = md5[:<span class="number">5</span>]</span><br><span class="line">	last = md5[-<span class="number">5</span>:]</span><br><span class="line">	as_cy = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	cp_cy = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">		as_cy += pre[i]+t_hex[i]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">		cp_cy += t_hex[i+<span class="number">3</span>]+last[i]</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		<span class="string">&#x27;as&#x27;</span>:<span class="string">&#x27;A1&#x27;</span>+as_cy+t_hex[-<span class="number">3</span>:],</span><br><span class="line">		<span class="string">&#x27;cp&#x27;</span>:t_hex[:<span class="number">3</span>]+cp_cy+<span class="string">&#x27;E1&#x27;</span></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>那么请求接口便可以进行完整的构造。</p>
<h2 id="3-构造请求"><a href="#3-构造请求" class="headerlink" title="3.构造请求"></a>3.构造请求</h2><p>根据抓包获取到的接口路径和请求头部，利用加密参数构造请求：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_more_news</span>(<span class="params">max_behot_time=<span class="number">0</span></span>):</span></span><br><span class="line">	<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">	:param max_behot_time: 翻页参数，根据返回结果的最后一条新闻的behot_time字段传入进行翻页</span></span><br><span class="line"><span class="string">	:return: 新闻数据</span></span><br><span class="line"><span class="string">	&#x27;&#x27;&#x27;</span></span><br><span class="line">	api = <span class="string">&#x27;https://m.toutiao.com/list/wxapp/?&#x27;</span></span><br><span class="line">	ASCP = ascp()</span><br><span class="line">	params = &#123;</span><br><span class="line">		<span class="string">&#x27;aid&#x27;</span>: <span class="string">&#x27;1162&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;ac&#x27;</span>: <span class="string">&#x27;wap&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;tag&#x27;</span>: <span class="string">&#x27;news_entertainment&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;json_raw&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;count&#x27;</span>: <span class="string">&#x27;20&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;as&#x27;</span>: ASCP[<span class="string">&#x27;as&#x27;</span>],</span><br><span class="line">		<span class="string">&#x27;cp&#x27;</span>: ASCP[<span class="string">&#x27;cp&#x27;</span>],</span><br><span class="line">		<span class="string">&#x27;enable_stick&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;max_behot_time&#x27;</span>: max_behot_time</span><br><span class="line">	&#125;</span><br><span class="line">	headers = &#123;</span><br><span class="line">		<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/532.36 (KHTML, like Gecko)&#x27;</span></span><br><span class="line">					  <span class="string">&#x27; Chrome/53.0.2785.143 Safari/537.36 MicroMessenger/7.0.9.501 NetType/WIFI&#x27;</span></span><br><span class="line">					  <span class="string">&#x27; MiniProgramEnv/Windows WindowsWechat&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;m.toutiao.com&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;X-Traffic-Type&#x27;</span>: <span class="string">&#x27;wxapp&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">		<span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;https://servicewechat.com/wx5bfb6b535af31da3/2/page-frame.html&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">	response = requests.get(api,params=params,headers=headers)</span><br><span class="line">	data = response.json()</span><br><span class="line">	<span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>
<p>返回结果：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;return_count&quot;</span>:<span class="number">6</span>,</span><br><span class="line">    <span class="attr">&quot;has_more&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;page_id&quot;</span>:<span class="string">&quot;/news_entertainment/&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;_ck&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;tt_webid&quot;</span>:<span class="string">&quot;6897190557271131655&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;html&quot;</span>:<span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;data&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v03004d90000buouprlab27bs3sapf9g&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;media_name&quot;</span>:<span class="string">&quot;幸福21问&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;ban_comment&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;abstract&quot;</span>:<span class="string">&quot;《幸福21问》通过明星生活状态和多元化价值观的呈现，让大众对于幸福作出更深层次的思考。旨在指导人们生活，传播积极思想、理念、引导人们合理、正确生活，从而起到沟通社会，传递幸福的作用。&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;video_detail_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;detail_video_large_image&quot;</span>:&#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/tos-cn-i-0004/2fa51da12cb04a738ed88d56fd207045&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">640</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">360</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v03004d90000buouprlab27bs3sapf9g&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;video_watch_count&quot;</span>:<span class="number">2502</span>,</span><br><span class="line">                <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32832</span>,</span><br><span class="line">                <span class="attr">&quot;direct_play&quot;</span>:<span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;image_list&quot;</span>:[</span><br><span class="line"></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;datetime&quot;</span>:<span class="string">&quot;2020-11-20 20:41&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;article_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;tag&quot;</span>:<span class="string">&quot;video_variety&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;has_m3u8_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;video_duration&quot;</span>:<span class="number">534</span>,</span><br><span class="line">            <span class="attr">&quot;display_dt&quot;</span>:<span class="number">1605849000</span>,</span><br><span class="line">            <span class="attr">&quot;has_mp4_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;aggr_type&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;cell_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;article_sub_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;bury_count&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>:<span class="string">&quot;《幸福21问第一季》第九集刘芸曝幸福秘籍，回应网络暴力&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_icon_style&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;tip&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_video&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;share_url&quot;</span>:<span class="string">&quot;https://m.toutiaoimg.cn/a6895555038950162951/?app=news_article&amp;is_hit_share_recommend=0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source&quot;</span>:<span class="string">&quot;幸福21问&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;comment_count&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;article_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6895555038950162951/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;large_mode&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;large_image_url&quot;</span>:<span class="string">&quot;http://p26-tt.byteimg.com/img/tos-cn-i-0004/2fa51da12cb04a738ed88d56fd207045~tplv-tt-cs0:640:360.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;publish_time&quot;</span>:<span class="number">1605849000</span>,</span><br><span class="line">            <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32833</span>,</span><br><span class="line">            <span class="attr">&quot;action_extra&quot;</span>:<span class="string">&quot;&#123;&quot;</span>channel_id<span class="string">&quot;: 3189398972&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;tag_id&quot;</span>:<span class="string">&quot;6895555038950162951&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_url&quot;</span>:<span class="string">&quot;/i6895555038950162951/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;display_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6895555038950162951/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;is_stick&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;item_id&quot;</span>:<span class="string">&quot;6895555038950162951&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;repin_count&quot;</span>:<span class="number">12</span>,</span><br><span class="line">            <span class="attr">&quot;cell_flag&quot;</span>:<span class="number">268697675</span>,</span><br><span class="line">            <span class="attr">&quot;source_open_url&quot;</span>:<span class="string">&quot;sslocal://profile?refer=video&amp;uid=85030278227&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;level&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;digg_count&quot;</span>:<span class="number">58</span>,</span><br><span class="line">            <span class="attr">&quot;behot_time&quot;</span>:<span class="number">1605876119</span>,</span><br><span class="line">            <span class="attr">&quot;hot&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;cursor&quot;</span>:<span class="number">1605876119999</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6895555038950162951/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;user_repin&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_image&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;video_style&quot;</span>:<span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;media_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;avatar_url&quot;</span>:<span class="string">&quot;http://p3-tt-ipv6.byteimg.com/img/user-avatar/b71f850307cbb51d126dfc653da6a937~120x256.image&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;media_id&quot;</span>:<span class="number">1642007268816907</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;幸福21问&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;user_verified&quot;</span>:<span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;group_id&quot;</span>:<span class="string">&quot;6895555038950162951&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;media_name&quot;</span>:<span class="string">&quot;娱乐拆穿姐&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;ban_comment&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;abstract&quot;</span>:<span class="string">&quot;昨晚，2020TVB万千星辉贺台庆晚会举行，又是一年TVB台庆，除了像姐这样为了工作而不得不看一眼地，还有多少剧迷会去关注?&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;image_list&quot;</span>:[</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/pgc-image/28df087dbc5546bd80d8366b4dd5fb3d&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">640</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">360</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/pgc-image/f32566e63f8d4f0da76c86e027a1b185&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">880</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">495</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/pgc-image/6a5c16ab994a48d3b6396159003a0d98&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">800</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">450</span></span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;datetime&quot;</span>:<span class="string">&quot;2020-11-20 20:31&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;article_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;more_mode&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;tag&quot;</span>:<span class="string">&quot;news_entertainment&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;has_m3u8_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;display_dt&quot;</span>:<span class="number">1605837868</span>,</span><br><span class="line">            <span class="attr">&quot;has_mp4_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;aggr_type&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;cell_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;article_sub_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;bury_count&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>:<span class="string">&quot;TVB昨晚台庆，但这样的宫心计，怕是看不到了&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_icon_style&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;tip&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_video&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;share_url&quot;</span>:<span class="string">&quot;http://toutiao.com/a6897020166434161163/?app=news_article&amp;is_hit_share_recommend=0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source&quot;</span>:<span class="string">&quot;娱乐拆穿姐&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;comment_count&quot;</span>:<span class="number">18</span>,</span><br><span class="line">            <span class="attr">&quot;article_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6897020166434161163/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;publish_time&quot;</span>:<span class="number">1605837868</span>,</span><br><span class="line">            <span class="attr">&quot;group_flags&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;gallary_image_count&quot;</span>:<span class="number">39</span>,</span><br><span class="line">            <span class="attr">&quot;action_extra&quot;</span>:<span class="string">&quot;&#123;&quot;</span>channel_id<span class="string">&quot;: 3189398972&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;tag_id&quot;</span>:<span class="string">&quot;6897020166434161163&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_url&quot;</span>:<span class="string">&quot;/i6897020166434161163/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;display_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6897020166434161163/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;is_stick&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;item_id&quot;</span>:<span class="string">&quot;6897020166434161163&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;repin_count&quot;</span>:<span class="number">74</span>,</span><br><span class="line">            <span class="attr">&quot;cell_flag&quot;</span>:<span class="number">268697611</span>,</span><br><span class="line">            <span class="attr">&quot;source_open_url&quot;</span>:<span class="string">&quot;sslocal://profile?uid=6041444276&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;level&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;digg_count&quot;</span>:<span class="number">190</span>,</span><br><span class="line">            <span class="attr">&quot;behot_time&quot;</span>:<span class="number">1605875519</span>,</span><br><span class="line">            <span class="attr">&quot;hot&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;cursor&quot;</span>:<span class="number">1605875519999</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6897020166434161163/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;user_repin&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_image&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;video_style&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;media_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;avatar_url&quot;</span>:<span class="string">&quot;http://p9-tt-ipv6.byteimg.com/large/user-avatar/2799deba7af6df3a237f0d3c88bcab61&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;media_id&quot;</span>:<span class="number">6041583451</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;娱乐拆穿姐&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;user_verified&quot;</span>:<span class="literal">false</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;group_id&quot;</span>:<span class="string">&quot;6897020166434161163&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v030040c0000buqti0fp10vlr7tjrgbg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;media_name&quot;</span>:<span class="string">&quot;经典热综回放&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;ban_comment&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;abstract&quot;</span>:<span class="string">&quot;综艺：宋小宝与刘德华比美，观众都快笑岔气了，太逗了！&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;video_detail_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;detail_video_large_image&quot;</span>:&#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/tos-cn-i-0004/7288eed5d6f24ecb93b06a332cbb4d9b&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">640</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">360</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v030040c0000buqti0fp10vlr7tjrgbg&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;video_watch_count&quot;</span>:<span class="number">464072</span>,</span><br><span class="line">                <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32832</span>,</span><br><span class="line">                <span class="attr">&quot;direct_play&quot;</span>:<span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;image_list&quot;</span>:[</span><br><span class="line"></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;datetime&quot;</span>:<span class="string">&quot;2020-11-20 20:21&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;article_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;tag&quot;</span>:<span class="string">&quot;video_variety&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;has_m3u8_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;video_duration&quot;</span>:<span class="number">1087</span>,</span><br><span class="line">            <span class="attr">&quot;display_dt&quot;</span>:<span class="number">1605753253</span>,</span><br><span class="line">            <span class="attr">&quot;has_mp4_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;aggr_type&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;cell_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;article_sub_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;bury_count&quot;</span>:<span class="number">5</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>:<span class="string">&quot;综艺：宋小宝与刘德华比美，观众都快笑岔气了，太逗了！&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_icon_style&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;tip&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_video&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;share_url&quot;</span>:<span class="string">&quot;https://m.toutiaoimg.cn/a6896657707307106830/?app=news_article&amp;is_hit_share_recommend=0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source&quot;</span>:<span class="string">&quot;经典热综回放&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;comment_count&quot;</span>:<span class="number">28</span>,</span><br><span class="line">            <span class="attr">&quot;article_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6896657707307106830/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;large_mode&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;large_image_url&quot;</span>:<span class="string">&quot;http://p3-tt-ipv6.byteimg.com/img/tos-cn-i-0004/7288eed5d6f24ecb93b06a332cbb4d9b~tplv-tt-cs0:640:360.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;publish_time&quot;</span>:<span class="number">1605753253</span>,</span><br><span class="line">            <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32833</span>,</span><br><span class="line">            <span class="attr">&quot;action_extra&quot;</span>:<span class="string">&quot;&#123;&quot;</span>channel_id<span class="string">&quot;: 3189398972&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;tag_id&quot;</span>:<span class="string">&quot;6896657707307106830&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_url&quot;</span>:<span class="string">&quot;/i6896657707307106830/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;display_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6896657707307106830/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;is_stick&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;item_id&quot;</span>:<span class="string">&quot;6896657707307106830&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;repin_count&quot;</span>:<span class="number">1630</span>,</span><br><span class="line">            <span class="attr">&quot;cell_flag&quot;</span>:<span class="number">268697675</span>,</span><br><span class="line">            <span class="attr">&quot;source_open_url&quot;</span>:<span class="string">&quot;sslocal://profile?refer=video&amp;uid=100190924891&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;level&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;digg_count&quot;</span>:<span class="number">7818</span>,</span><br><span class="line">            <span class="attr">&quot;behot_time&quot;</span>:<span class="number">1605874919</span>,</span><br><span class="line">            <span class="attr">&quot;hot&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;cursor&quot;</span>:<span class="number">1605874919999</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6896657707307106830/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;user_repin&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_image&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;video_style&quot;</span>:<span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;media_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;avatar_url&quot;</span>:<span class="string">&quot;http://p1-tt-ipv6.byteimg.com/large/pgc-image/223001cc8e3b4fa78b9a333a740928c8&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;media_id&quot;</span>:<span class="number">1603333076610062</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;经典热综回放&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;user_verified&quot;</span>:<span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;group_id&quot;</span>:<span class="string">&quot;6896657707307106830&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v030040e0000bt1od212om8ea8vc37c0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;media_name&quot;</span>:<span class="string">&quot;大咖聊娱&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;ban_comment&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;abstract&quot;</span>:<span class="string">&quot;朱之文成名前老婆的样子，再看现在，差距大的就像换了媳妇一样&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;video_detail_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;detail_video_large_image&quot;</span>:&#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/tos-cn-i-0004/4cc259eb42704023b9322b6b70d4e875&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">640</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">360</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v030040e0000bt1od212om8ea8vc37c0&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;video_watch_count&quot;</span>:<span class="number">487712</span>,</span><br><span class="line">                <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32832</span>,</span><br><span class="line">                <span class="attr">&quot;direct_play&quot;</span>:<span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;image_list&quot;</span>:[</span><br><span class="line"></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;datetime&quot;</span>:<span class="string">&quot;2020-11-20 20:11&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;article_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;tag&quot;</span>:<span class="string">&quot;video_entertainment&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;has_m3u8_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;video_duration&quot;</span>:<span class="number">268</span>,</span><br><span class="line">            <span class="attr">&quot;display_dt&quot;</span>:<span class="number">1598261570</span>,</span><br><span class="line">            <span class="attr">&quot;has_mp4_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;aggr_type&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;cell_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;article_sub_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;bury_count&quot;</span>:<span class="number">8</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>:<span class="string">&quot;朱之文成名前老婆的样子，再看现在，差距大的就像换了媳妇一样&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_icon_style&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;tip&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_video&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;share_url&quot;</span>:<span class="string">&quot;https://m.toutiaoimg.cn/a6864481176476877319/?app=news_article&amp;is_hit_share_recommend=0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source&quot;</span>:<span class="string">&quot;大咖聊娱&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;comment_count&quot;</span>:<span class="number">64</span>,</span><br><span class="line">            <span class="attr">&quot;article_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6864481176476877319/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;large_mode&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;large_image_url&quot;</span>:<span class="string">&quot;http://p26-tt.byteimg.com/img/tos-cn-i-0004/4cc259eb42704023b9322b6b70d4e875~tplv-tt-cs0:640:360.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;publish_time&quot;</span>:<span class="number">1598261570</span>,</span><br><span class="line">            <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32833</span>,</span><br><span class="line">            <span class="attr">&quot;action_extra&quot;</span>:<span class="string">&quot;&#123;&quot;</span>channel_id<span class="string">&quot;: 3189398972&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;tag_id&quot;</span>:<span class="string">&quot;6864481176476877319&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_url&quot;</span>:<span class="string">&quot;/i6864481176476877319/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;display_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6864481176476877319/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;is_stick&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;item_id&quot;</span>:<span class="string">&quot;6864481176476877319&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;repin_count&quot;</span>:<span class="number">547</span>,</span><br><span class="line">            <span class="attr">&quot;cell_flag&quot;</span>:<span class="number">268697675</span>,</span><br><span class="line">            <span class="attr">&quot;source_open_url&quot;</span>:<span class="string">&quot;sslocal://profile?refer=video&amp;uid=105485989402&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;level&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;digg_count&quot;</span>:<span class="number">3499</span>,</span><br><span class="line">            <span class="attr">&quot;behot_time&quot;</span>:<span class="number">1605874319</span>,</span><br><span class="line">            <span class="attr">&quot;hot&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;cursor&quot;</span>:<span class="number">1605874319999</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6864481176476877319/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;user_repin&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_image&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;video_style&quot;</span>:<span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;media_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;avatar_url&quot;</span>:<span class="string">&quot;http://p1-tt-ipv6.byteimg.com/large/pgc-image/a1cd874717af4d97acbd1f8d32ada720&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;media_id&quot;</span>:<span class="number">1665358507201550</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;大咖聊娱&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;user_verified&quot;</span>:<span class="literal">false</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;group_id&quot;</span>:<span class="string">&quot;6864481176476877319&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v03004090000bumf8jj9fmqkhnkdu2k0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;media_name&quot;</span>:<span class="string">&quot;最爱综艺说&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;ban_comment&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;abstract&quot;</span>:<span class="string">&quot;非常了得：他是少林十八铜人之一，曾是谢霆锋替身，还上过奥运会&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;video_detail_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;detail_video_large_image&quot;</span>:&#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/tos-cn-i-0004/006b953c84f4433596d13b55fbe95142&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">640</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">360</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v03004090000bumf8jj9fmqkhnkdu2k0&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;video_watch_count&quot;</span>:<span class="number">478605</span>,</span><br><span class="line">                <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32832</span>,</span><br><span class="line">                <span class="attr">&quot;direct_play&quot;</span>:<span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;image_list&quot;</span>:[</span><br><span class="line"></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;datetime&quot;</span>:<span class="string">&quot;2020-11-20 19:51&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;article_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;tag&quot;</span>:<span class="string">&quot;video_variety&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;has_m3u8_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;video_duration&quot;</span>:<span class="number">790</span>,</span><br><span class="line">            <span class="attr">&quot;display_dt&quot;</span>:<span class="number">1605170382</span>,</span><br><span class="line">            <span class="attr">&quot;has_mp4_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;aggr_type&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;cell_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;article_sub_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;bury_count&quot;</span>:<span class="number">7</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>:<span class="string">&quot;非常了得：他是少林十八铜人之一，曾是谢霆锋替身，还上过奥运会&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_icon_style&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;tip&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_video&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;share_url&quot;</span>:<span class="string">&quot;https://m.toutiaoimg.cn/a6894154298528268813/?app=news_article&amp;is_hit_share_recommend=0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source&quot;</span>:<span class="string">&quot;最爱综艺说&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;comment_count&quot;</span>:<span class="number">46</span>,</span><br><span class="line">            <span class="attr">&quot;article_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6894154298528268813/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;large_mode&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;large_image_url&quot;</span>:<span class="string">&quot;http://p26-tt.byteimg.com/img/tos-cn-i-0004/006b953c84f4433596d13b55fbe95142~tplv-tt-cs0:640:360.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;publish_time&quot;</span>:<span class="number">1605170382</span>,</span><br><span class="line">            <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32833</span>,</span><br><span class="line">            <span class="attr">&quot;action_extra&quot;</span>:<span class="string">&quot;&#123;&quot;</span>channel_id<span class="string">&quot;: 3189398972&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;tag_id&quot;</span>:<span class="string">&quot;6894154298528268813&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_url&quot;</span>:<span class="string">&quot;/i6894154298528268813/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;display_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6894154298528268813/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;is_stick&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;item_id&quot;</span>:<span class="string">&quot;6894154298528268813&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;repin_count&quot;</span>:<span class="number">821</span>,</span><br><span class="line">            <span class="attr">&quot;cell_flag&quot;</span>:<span class="number">268697675</span>,</span><br><span class="line">            <span class="attr">&quot;source_open_url&quot;</span>:<span class="string">&quot;sslocal://profile?refer=video&amp;uid=100340306758&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;level&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;digg_count&quot;</span>:<span class="number">4952</span>,</span><br><span class="line">            <span class="attr">&quot;behot_time&quot;</span>:<span class="number">1605873119</span>,</span><br><span class="line">            <span class="attr">&quot;hot&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;cursor&quot;</span>:<span class="number">1605873119999</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6894154298528268813/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;user_repin&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_image&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;video_style&quot;</span>:<span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;media_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;avatar_url&quot;</span>:<span class="string">&quot;http://p3-tt-ipv6.byteimg.com/large/906100005d96091bd0a2&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;media_id&quot;</span>:<span class="number">1603333824563207</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;最爱综艺说&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;user_verified&quot;</span>:<span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;group_id&quot;</span>:<span class="string">&quot;6894154298528268813&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v020043f0000bur6ski8r9gbs2nut8l0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;media_name&quot;</span>:<span class="string">&quot;彪子艾剪辑&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;ban_comment&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;abstract&quot;</span>:<span class="string">&quot;25年前金星有多美？刚做完变性手术接受采访，气质太好了&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;video_detail_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;detail_video_large_image&quot;</span>:&#123;</span><br><span class="line">                    <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/tos-cn-i-0004/3ba395a6e3c840a782706dadddbb91fb&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;width&quot;</span>:<span class="number">640</span>,</span><br><span class="line">                    <span class="attr">&quot;height&quot;</span>:<span class="number">360</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;video_id&quot;</span>:<span class="string">&quot;v020043f0000bur6ski8r9gbs2nut8l0&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;video_watch_count&quot;</span>:<span class="number">107779</span>,</span><br><span class="line">                <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32832</span>,</span><br><span class="line">                <span class="attr">&quot;direct_play&quot;</span>:<span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;image_list&quot;</span>:[</span><br><span class="line"></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;datetime&quot;</span>:<span class="string">&quot;2020-11-20 19:41&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;article_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;tag&quot;</span>:<span class="string">&quot;video_entertainment&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;has_m3u8_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;video_duration&quot;</span>:<span class="number">318</span>,</span><br><span class="line">            <span class="attr">&quot;display_dt&quot;</span>:<span class="number">1605831300</span>,</span><br><span class="line">            <span class="attr">&quot;has_mp4_video&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;aggr_type&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;cell_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;article_sub_type&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;bury_count&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>:<span class="string">&quot;25年前金星有多美？刚做完变性手术接受采访，气质太好了&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_icon_style&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;tip&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_video&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;share_url&quot;</span>:<span class="string">&quot;https://m.toutiaoimg.cn/a6896831964473459208/?app=news_article&amp;is_hit_share_recommend=0&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source&quot;</span>:<span class="string">&quot;彪子艾剪辑&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;comment_count&quot;</span>:<span class="number">28</span>,</span><br><span class="line">            <span class="attr">&quot;article_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6896831964473459208/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;publish_time&quot;</span>:<span class="number">1605831300</span>,</span><br><span class="line">            <span class="attr">&quot;group_flags&quot;</span>:<span class="number">32833</span>,</span><br><span class="line">            <span class="attr">&quot;middle_mode&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;action_extra&quot;</span>:<span class="string">&quot;&#123;&quot;</span>channel_id<span class="string">&quot;: 3189398972&#125;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;tag_id&quot;</span>:<span class="string">&quot;6896831964473459208&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;source_url&quot;</span>:<span class="string">&quot;/i6896831964473459208/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;display_url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6896831964473459208/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;is_stick&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;item_id&quot;</span>:<span class="string">&quot;6896831964473459208&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;repin_count&quot;</span>:<span class="number">188</span>,</span><br><span class="line">            <span class="attr">&quot;cell_flag&quot;</span>:<span class="number">268697675</span>,</span><br><span class="line">            <span class="attr">&quot;source_open_url&quot;</span>:<span class="string">&quot;sslocal://profile?refer=video&amp;uid=2805602832379735&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;level&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;digg_count&quot;</span>:<span class="number">960</span>,</span><br><span class="line">            <span class="attr">&quot;behot_time&quot;</span>:<span class="number">1605872519</span>,</span><br><span class="line">            <span class="attr">&quot;hot&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;cursor&quot;</span>:<span class="number">1605872519999</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>:<span class="string">&quot;http://toutiao.com/group/6896831964473459208/&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;image_url&quot;</span>:<span class="string">&quot;https://p3.pstatp.com/list/tos-cn-i-0004/3ba395a6e3c840a782706dadddbb91fb&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;user_repin&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;has_image&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;video_style&quot;</span>:<span class="number">2</span>,</span><br><span class="line">            <span class="attr">&quot;media_info&quot;</span>:&#123;</span><br><span class="line">                <span class="attr">&quot;avatar_url&quot;</span>:<span class="string">&quot;http://p26-tt.byteimg.com/large/pgc-image/c2cb832d53a5454d816475664b4420c4&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;media_id&quot;</span>:<span class="number">1669403691802628</span>,</span><br><span class="line">                <span class="attr">&quot;name&quot;</span>:<span class="string">&quot;彪子艾剪辑&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;user_verified&quot;</span>:<span class="literal">false</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;group_id&quot;</span>:<span class="string">&quot;6896831964473459208&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2020/11/16/%E5%85%B3%E4%BA%8EPython%E7%88%AC%E8%99%AB%E7%A7%8D%E7%B1%BB%E3%80%81%E6%B3%95%E5%BE%8B%E3%80%81%E8%BD%AE%E5%AD%90%E7%9A%84%E4%B8%80%E4%BA%8C%E4%B8%89/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>上一页</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime" title="更新时间"></i>
              2020-11-20 16:50:06
            </span>
            
                  <span class="post-categories">
                    <i class="iconfont icon-bookmark" title="分类"></i>
                    
                    <span class="span--category">
                      <a href="/categories/%E5%8F%8D%E7%BC%96%E8%AF%91/" title="反编译">
                        <b>#</b> 反编译
                      </a>
                    </span>
                    
                  </span>
              
                  <span class="post-tags">
                    <i class="iconfont icon-tags" title="标签"></i>
                    
                    <span class="span--tag">
                      <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" title="微信小程序">
                        <b>#</b> 微信小程序
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/2020/11/23/%E5%BE%97%E7%89%A9PC%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3%E8%A7%A3%E6%9E%90/" target="_self">
                <span>下一页</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div class="post-catalog" id="catalog">
    <div class="title">目录</div>
    <div class="catalog-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83"><span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7"><span class="toc-text">工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E8%A7%A3%E5%AF%86%E5%B0%8F%E7%A8%8B%E5%BA%8Fwxapkg%E5%8C%85"><span class="toc-text">0.解密小程序wxapkg包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8F%8D%E7%BC%96%E8%AF%91wxapkg%E5%8C%85"><span class="toc-text">1.反编译wxapkg包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AF%BB%E6%89%BE%E5%85%B3%E9%94%AE%E5%8A%A0%E5%AF%86%E8%AF%B7%E6%B1%82%E5%AD%97%E6%AE%B5"><span class="toc-text">2.寻找关键加密请求字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9E%84%E9%80%A0%E8%AF%B7%E6%B1%82"><span class="toc-text">3.构造请求</span></a></li></ol>
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        


  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>

  <div id="vcomments"></div>

  <script>
    new Valine({
      el: '#vcomments',
      appId: '3W8j3d5f36B5M6g3zLqIjrEf-gzGzoHsz',
      appKey: 'Ga5BSOd8a7K0c3ETJGfiFRC0',
      placeholder: '知无不言，言无不尽~',
      avatar: 'retro',
      lang: 'zh-CN'
    })
  </script>




      </div>
    
  </div>


        <div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" target="_blank" rel="noopener" href="https://github.com/01ly">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
        <li>
          <a title="rss" href="/atom.xml">
            <i class="iconfont icon-rss"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/01ly">2019-2021 © linkin</a>
        
    </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">浙ICP备18022544号-3</a>
        
    </div>
  
</div>

      </div>

      <div class="back-to-top hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



      
  <div class="search-icon" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="搜索...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>未找到search.xml文件，具体请参考：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>请求失败，尝试重新刷新页面或稍后重试。<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




    </div>
  </body>
</html>
